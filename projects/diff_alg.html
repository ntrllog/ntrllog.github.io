<!DOCTYPE html>
<html lang="en">
  <head>
    <!--
                                      _
        /\     _             _   _   | |             __    __
       /  \   | |      /\   | \ | |  | |       /\   |  \  /  |
      /    \  | |     /  \  |  \| |  | |      /  \  | |\\//| |
     / ____ \ | |__  / __ \ | |\  |  | |___  / __ \ | | \/ | |
    /_/    \_\|____|/_/  \_\|_| \_|  |_____|/_/  \_\|_|    |_|
                          _   _
     _  _    _     _  _  | | | |   __     ____
    | |/ \  | |_  | |/_| | | | |  /  \   /    \
    | |   | |  _| |  /   | | | | | || | |  ||  |
    | |   | | |_  | |    | | | | | || | |  ||  |
    |_|   | |___| |_|    |_| |_|  \__/   \____/|
                                               |
                                          ____/
    -->
    <title>ntrllog | Linear Algebra in Differential Equations</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <link rel="shortcut icon" type="image/png" href="../pictures/favicon.ico"/>
    <link href="../css/content.css" rel="stylesheet">
  </head>
  <body>
    <div class="container ln-line-height">
      <a href="projects.html"><i class="fas fa-long-arrow-alt-left fa-2x"></i></a>
      <h1>Linear Algebra in Differential Equations</h1>
      <hr>
      <p>Shortcut to this page: <a href="diff_alg.html">ntrllog.netlify.app/diff_alg</a></p>
      <p>Notes provided by Professor Guershon Harel</p>
      <p>We have the following setup:</p>
      <div class="ln-center">
        <p>`{(y'(t) = Ay(t)),(y(0)=C):}`</p>
      </div>
      <p>where `A` is an `nxxn` matrix and `C` is an `nxx1` vector, and we want to find a solution to that system, i.e., we want to solve for `y(t)`. Before we begin, we need to introduce some concepts from calculus.</p>
      <h2 id="calculus">Calclulus Stuff</h2>
      <div class="ln-box">
        <p>The derivative of `e^(alphax)` is `alpha*e^(alphax)`.</p>
        <p>Notice that the derivative looks very similar to the original function. <strong>This is a special case where taking a derivative of something results in itself</strong>.</p>
      </div>
      <div class="ln-box">
        <p>`e^x` is defined to be</p>
        <div class="ln-center">
          <p>`e^color(red)(x) = sum_(i=0)^(oo)1/(i!)color(red)(x)^i`</p>
          <p>(which is equal to `1/(0!)x^0 + 1/(1!)x^1 + 1/(2!)x^2 + 1/(3!)x^3 + ...`, but this is irrelevant)</p>
        </div>
        <p>Using that definition, we can plug in anything for `x` to get different results.</p>
        <p>If we have `x=2x`, then</p>
        <div class="ln-center">
          <p>`e^(color(red)(2x)) = sum_(i=0)^(oo)1/(i!)(color(red)(2x))^i`</p>
          <p>`= sum_(i=0)^(oo)1/(i!)2^ix^i`</p>
          <p>(we can distribute the exponent to each term inside the parentheses)</p>
        </div>
        <p>If we have `x=t`, then</p>
        <div class="ln-center">
          <p>`e^(color(red)(t)) = sum_(i=0)^(oo)1/(i!)color(red)(t)^i`</p>
        </div>
        <p>If we have `x=lambdat`, then</p>
        <div class="ln-center">
          <p>`e^(color(red)(lambdat)) = sum_(i=0)^(oo)1/(i!)(color(red)(lambdat))^i`</p>
          <p>`= sum_(i=0)^(oo)1/(i!)lambda^it^i`</p>
          <p>(we can distribute the exponent to each term inside the parentheses)</p>
        </div>
      </div>
      <h2>Solving for `y(t)`</h2>
      <p>Going back to our system</p>
      <div class="ln-center">
        <p>`{(y'(t) = Ay(t)),(y(0)=C):}`</p>
      </div>
      <p>we notice that the derivative of `y(t)`, denoted by `y'(t)`, is `y(t)` itself. This suggests that `y(t) = Ce^(At)` (Refer back to the first box in the calculus stuff).</p>
      <p>We could simplify `y(t)` by introducing eigenvalues and eigenvectors.</p>
      <p>So suppose `C` is an eigenvector of `A`, i.e., `AC = lambdaC` for some scalar `lambda`.</p>
      <p>Recall that</p>
      <div class="ln-center">
        <p>`e^(color(red)(x)) = sum_(i=0)^(oo)1/(i!)color(red)(x)^i`</p>
      </div>
      <p>So it is also true that</p>
      <div class="ln-center">
        <p>`e^(color(red)(At)) = sum_(i=0)^(oo)1/(i!)(color(red)(At))^i`</p>
      </div>
      <p>We can rewrite `y(t) = Ce^(At)` to get</p>
      <div class="ln-center">
        <p>`y(t) = e^(color(red)(At))C`</p>
        <p>`= sum_(i=0)^(oo)1/(i!)(color(red)(At))^iC`</p>
        <p>`= sum_(i=0)^(oo)1/(i!)A^it^iC`</p>
        <p>`= sum_(i=0)^(oo)1/(i!)t^icolor(blue)(A^i)C`</p>
      </div>
      <div class="ln-box">
        <p>There's a result in linear algebra that `color(blue)(A^iC = lambda^iC)`.</p>
        <p>The proof isn't relevant, but I'll provide it.</p>
        <div class="collapse" id="powers">
          <p>Well, this isn't a real proof because this is for a specific case (when `i=2`), but it is generalizable.</p>
          <p>`A^2C = A AC`</p>
          <div class="ln-center">
            <p>`= A(AC)`</p>
            <p>`= A(lambdaC)`
            <p>`= AlambdaC`</p>
            <p>`= lambdaAC`</p>
            <p>`= lambda(AC)`</p>
            <p>`= lambda(lambdaC)`</p>
            <p>`= lambdalambdaC`</p>
            <p>`= lambda^2C`</p>
          </div>
        </div>
        <button class="btn" type="button" data-bs-toggle="collapse" data-bs-target="#powers" aria-expanded="false" aria-controls="powers">Answer</button>
      </div>
      <p>So we can continue rewriting to get</p>
      <div class="ln-center">
        <p>`= sum_(i=0)^(oo)1/(i!)t^icolor(blue)(lambda^i)C`</p>
        <p>`= sum_(i=0)^(oo)1/(i!)lambda^it^iC`</p>
        <p>`= sum_(i=0)^(oo)1/(i!)(color(red)(lambdat))^iC`</p>
        <p>`= e^(color(red)(lambdat))C`</p>
        <p>(refer back to the last example in the second box in the <a href="#calculus">calculus stuff</a>)</p>
      </div>
      <p>So we found that `y(t) = Ce^(lambdat)`. This is an easily computable solution because we can just plug that into good ol' MATLAB. However, to get this result, we made a very important assumption: `C` is an eigenvector of `A`.</p>
      <p><strong>`y(t) = Ce^(lambdat)` is the easily computable solution if `C` is an eigenvector of `A`</strong>.</p>
      <p>Does that mean that there's no hope if `C` is not an eigenvector of `A`? Actually, no.</p>
      <p><strong>If `C` is a linear combination of the eigenvectors of `A`, then there is still an easily computable solution</strong>.</p>
      <div class="ln-box">
        <p>Being a linear combination of the eigenvectors of `A` means that there exist numbers `c_1, c_2, ..., c_k` such that</p>
        <div class="ln-center">
          <p>`C = c_1a_1 + c_2a_2 + ... + c_ka_k`</p>
        </div>
        <p>where `a_1, a_2, ..., a_k` are the eigenvectors of `A`.</p>
      </div>
      <p>So if we know the eigenvectors (and eigenvalues) of `A`, we can rewrite `y(t)` as</p>
      <div class="ln-center">
        <p>`y(t) = e^(At)C`</p>
        <p>`= e^(At)(c_1a_1 + c_2a_2 + ... + c_ka_k)`</p>
        <p>`= c_1e^(At)a_1 + c_2e^(At)a_2 + ... + c_ke^(At)a_k`</p>
        <p>`= c_1e^(lambda_1t)a_1 + c_2e^(lambda_2t)a_2 + ... + c_ke^(lambda_kt)a_k`</p>
      </div>
      <p><strong>So we get that `y(t) = c_1e^(lambda_1t)a_1 + c_2e^(lambda_2t)a_2 + ... + c_ke^(lambda_kt)a_k`, which is also an easily computable solution</strong>.</p>
      <h2>Example 1</h2>
      <div class="ln-box">
        <p>Is there an easily computable solution for the system</p>
        <div class="ln-center">
          <p>`{(y'(t) = Ay(t)),(y(0)=C):}`</p>
        </div>
        <p>given that</p>
        <div class="ln-center">
          <p>`A = [[1, -2],[0, -1]]` and `C = [[1],[1]]`?</p>
        </div>
        <p>If so, find an easily computable solution for the system.</p>
      </div>
      <p>Recall the two results we found:</p>
      <ol>
        <li>`y(t) = Ce^(lambdat)` is the easily computable solution if `C` is an eigenvector of `A`</li>
        <li>`y(t) = c_1e^(lambda_1t)a_1 + c_2e^(lambda_2t)a_2 + ... + c_ke^(lambda_kt)a_k` is the easily computable solution if `C` is a linear combination of the eigenvectors of `A`</li>
      </ol>
      <p>First, we should check if `C` is an eigenvector of `A`.</p>
      <p>`C` is an eigenvector of `A` if there exists a scalar `lambda` such that `AC = lambdaC`.</p>
      <p>So we should multiply `A` and `C` and see if we can find a `lambda` that satisfies that equation.</p>
      <div class="ln-center">
        <p>`AC = [[1, -2],[0, -1]][[1],[1]] = [[-1],[-1]] = -1[[1],[1]]`</p>
      </div>
      <p>Well, it looks like `lambda=-1`, so `C` is an eigenvector of `A`.</p>
      <p>This means the easily computable solution is</p>
      <div class="ln-center">
        <p>`y(t) = Ce^(lambdat) = color(red)(e^(-t)[[1],[1]])`</p>
      </div>
      <h2>Example 2</h2>
      <div class="ln-box">
        <p>Is there an easily computable solution for the system</p>
        <div class="ln-center">
          <p>`{(y'(t) = Ay(t)),(y(0)=C):}`</p>
        </div>
        <p>given that</p>
        <div class="ln-center">
          <p>`A = [[2, 3],[-1, -2]]` and `C = [[-1],[2]]`?</p>
        </div>
        <p>If so, find an easily computable solution for the system.</p>
      </div>
      <p>Recall the two results we found:</p>
      <ol>
        <li>`y(t) = Ce^(lambdat)` is the easily computable solution if `C` is an eigenvector of `A`</li>
        <li>`y(t) = c_1e^(lambda_1t)a_1 + c_2e^(lambda_2t)a_2 + ... + c_ke^(lambda_kt)a_k` is the easily computable solution if `C` is a linear combination of the eigenvectors of `A`</li>
      </ol>
      <p>First, we should check if `C` is an eigenvector of `A`.</p>
      <p>`C` is an eigenvector of `A` if there exists a scalar `lambda` such that `AC = lambdaC`.</p>
      <p>So we should multiply `A` and `C` and see if we can find a `lambda` that satisfies that equation.</p>
      <div class="ln-center">
        <p>`AC = [[2, 3],[-1, -2]][[-1],[2]] = [[4],[-3]]`</p>
      </div>
      <p>It doesn't look like we can multiply `[[-1],[2]]` by a number to get `[[4],[-3]]`, so `C` is not an eigenvector of `A`.</p>
      <p>Next, we should check if `C` is a linear combination of the eigenvectors of `A`.</p>
      <p>To do this, we need to find the eigenvectors of `A`. And to do that, we need to find the eigenvalues of `A`.</p>
      <p>To find the eigenvalues of `A`, we row reduce until it is in row echelon form:</p>
      <div class="ln-center">
        <p>`[[2, 3],[-1, -2]] rarr [[-1, -2],[2, 3]] rarr [[-1, -2],[0, -1]] rarr [[1, 2], [0, -1]]`</p>
      </div>
      <p>The eigenvalues are the numbers along the diagonal, which are `1` and `-1`.</p>
      <p>Now that we have the eigenvalues, we can find the eigenvectors.</p>
      <p>We have</p>
      <div class="ln-center">
        <p>`Ax = lambdax`</p>
        <p>`= Ax - lambdax = 0`</p>
        <p>`= (A - lambdaI)x = 0`</p>
      </div>
      <p>For `lambda = 1`, we have</p>
      <div class="ln-center">
        <p>`(A-I)x = 0`</p>
        <p>`([[2, 3],[-1, -2]] - [[1, 0], [0, 1]])x = 0`</p>
        <p>`[[1, 3],[-1, -3]]x = 0`</p>
      </div>
      <p>`x` is the eigenvector, so we have to try and solve for it. We do this by setting up the augmented matrix and row reducing.</p>
      <div class="ln-center">
        <p>`[[1, 3, |, 0], [-1, -3, |, 0]] rarr [[1, 3, |, 0], [0, 0, |, 0]]`</p>
      </div>
      <p>From this, we conclude that</p>
      <div class="ln-center">
        <p>`x_2` is a free variable, let it be equal to `1`</p>
        <p>`x_1 = -3x_2`.</p>
      </div>
      <p>So an eigenvector `x` for the eigenvalue `1` is equal to</p>
      <div class="ln-center">
        <p>`x = [[x_1],[x_2]] = [[-3x_2],[x_2]] = x_2[[-3],[1]] = [[-3],[1]]`</p>
      </div>
      <p>For `lambda = -1`, we have</p>
      <div class="ln-center">
        <p>`(A+I)z = 0`</p>
        <p>`([[2, 3],[-1, -2]] + [[1, 0], [0, 1]])z = 0`</p>
        <p>`[[3, 3],[-1, -1]]z = 0`</p>
      </div>
      <p>`z` is the eigenvector, so we have to try and solve for it. We do this by setting up the augmented matrix and row reducing.</p>
      <div class="ln-center">
        <p>`[[3, 3, |, 0], [-1, -1, |, 0]] rarr [[1, 1, |, 0], [-1, -1, |, 0]] rarr [[1, 1, |, 0], [0, 0, |, 0]]`</p>
      </div>
      <p>From this we conclude that</p>
      <div class="ln-center">
        <p>`z_2` is a free variable, let it be equal to `1`</p>
        <p>`z_1 = -z_2`.</p>
      </div>
      <p>So an eigenvector `z` for the eigenvalue `-1` is equal to</p>
      <div class="ln-center">
        <p>`z = [[z_1],[z_2]] = [[-z_2],[z_2]] = z_2[[-1],[1]] = [[-1],[1]]`</p>
      </div>
      <p>So two eigenvectors of `A` are `[[-3],[1]]` and `[[-1],[1]]`. Recall that the goal was to determine if `C = [[-1],[2]]` was a linear combination of the eigenvectors of `A`. To determine this, we need to row reduce yet again.</p>
      <div class="ln-box">
        <p>For `C = [[-1],[2]]` to be a linear combination of `[[-3],[1]]` and `[[-1],[1]]`, there need to be numbers `c_1` and `c_2` such that `[[-1],[2]] = c_1[[-3],[1]] + c_2[[-1],[1]]`.</p>
        <p>This is equivalent to setting up the augmented matrix `[[-3, -1, |, -1], [1, 1, |, 2]]` and row reducing to find `c_1` and `c_2`.</p>
        <div class="collapse" id="rowreducelc">
          <p>`[[-1],[2]] = c_1[[-3],[1]] + c_2[[-1],[1]]` is equivalent to</p>
          <div class="ln-center">
            <p>`-3c_1 - c_2 = -1`</p>
            <p>`c_1 + c_2 = 2`</p>
          </div>
          <p>Now consider the equation</p>
          <div class="ln-center">
            <p>`[[-3, -1], [1, 1]][[c_1],[c_2]] = [[-1],[2]]`</p>
          </div>
          <p>Notice that if we do the multiplication, we get the exact two equations above.</p>
          <p>Also notice that solving for `c_1` and `c_2` requires setting up the augmented matrix and row reducing (that's how we've learned to solve these types of problems).</p>
          <p>This is why we row reduce the augmented matrix when we want to find out if something is a linear combination of something else.</p>
        </div>
        <button class="btn" type="button" data-bs-toggle="collapse" data-bs-target="#rowreducelc" aria-expanded="false" aria-controls="rowreducelc">Answer</button>
      </div>
      <div class="ln-center">
        <p>`[[-3, -1, |, -1], [1, 1, |, 2]] rarr [[1, 1, |, 2], [-3, -1, |, -1]] rarr [[1, 1, |, 2], [0, 2, |, 5]]`</p>
      </div>
      <p>From this we conclude that</p>
      <div class="ln-center">
        <p>`2c_2 = 5 implies c_2 = 5/2`</p>
        <p>`c_1 + c_2 = 2 implies c_1 = 2 - 5/2 = -1/2`</p>
      </div>
      <p>This means that if we do `c_1[[-3],[1]] + c_2[[-1],[1]] = -1/2[[-3],[1]] + 5/2[[-1],[1]]`, we should get `[[-1],[2]]`, which we do.</p>
      <p>So `C` is a linear combination of the eigenvectors of `A`, which means there exists an easily computable solution:</p>
      <div class="ln-center">
        <p>`y(t) = c_1e^(lambda_1t)a_1 + c_2e^(lambda_2t)a_2 = color(red)(-1/2e^t[[-3],[1]] + 5/2e^(-t)[[-1],[1]])`</p>
      </div>
    </div> <!-- container -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
  </body>
</html>
